---
title: "Diversity Project Abundances"
author: "Joshua"
date: "4/1/2021"
output: html_document
---

```{r}
rm(list=ls())
```

# Importing data into R

```{r}
site_species <- read.csv("alpine_ridge_data/OTU_table.csv", header = TRUE)
site_species.t <- t(site_species)
```

#Rarefaction

```{r}
library(vegan)
richness <- rowSums((site_species.t > 0) * 1)
print(richness)
minimum.r <- min(rowSums(site_species.t))
rarefy <- rarefy(x = site_species.t, sample = minimum.r, se = TRUE)

rarecurve(x = site_species.t, step = 20, col = "blue", cex = .6, las = 1)
abline(0, 1, col = 'red')
text(200, 100, "1:1", pos = 2, col = 'red')
```
## Relative Abundance Visualization

```{r}
genus <- read.csv("alpine_ridge_data/genus_table.csv", header = TRUE)
# Converting to Long Format
library(reshape2)
genus_long <- melt(genus, id.vars = "Genus", variable.name = "Sample")

# Creating Graph of data
library(ggplot2)
genus_graph <- ggplot(data = genus_long, mapping = aes(x = Sample,  y = value, fill = Genus))
genus_graph <- genus_graph + geom_bar(stat="identity")
genus_graph <- genus_graph + labs(y = "Relative Abundance", x = "Sample", title = "Genus Relative Abundances") + theme_classic()
genus_graph <- genus_graph + theme(legend.position = "None")
genus_graph <- genus_graph + theme(axis.text.x = element_text(angle = 90, vjust = 0.5, hjust=1))
genus_graph
```





